<%= form_with(model: link, class: "contents", data: { controller: "clipboard" }) do |form| %>
  <% if link.errors.any? %>
    <div id="error_explanation" class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-lg mt-3">
      <h2><%= pluralize(link.errors.count, "error") %> prohibited this link from being saved:</h2>
      <ul>
        <% link.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- ãƒœãƒ¼ãƒ‰é¸æŠ -->
  <div class="my-5">
    <%= form.label :board_id, "Board" %>
    <%= form.collection_select :board_id, current_user.boards, :id, :name, { prompt: "ãƒœãƒ¼ãƒ‰ã‚’é¸æŠ" }, { class: "block shadow rounded-md border border-gray-200 outline-none px-3 py-2 mt-2 w-full" } %>
  </div>

  <!-- ç”»åƒç·¨é›†ã‚¨ãƒªã‚¢ -->
  <div class="my-5 p-4 border border-gray-200 rounded-lg bg-gray-50">
    <label class="block font-bold mb-2">Thumbnail Image</label>
    
    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div data-clipboard-target="container" class="w-full h-48 bg-gray-200 rounded mb-4 flex items-center justify-center border border-dashed border-gray-400 overflow-hidden">
      <% if link.thumbnail.attached? %>
        <%= image_tag link.thumbnail.variant(resize_to_limit: [300, 200]), class: "object-contain w-full h-full" %>
      <% else %>
        <%= image_tag 'default_card.png' %>
      <% end %>
    </div>

    <div class="flex gap-2 items-center">
      <!-- ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒœã‚¿ãƒ³ -->
      <%= form.file_field :thumbnail, 
          accept: "image/*",
          class: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",
          data: { clipboard_target: "input", action: "change->clipboard#previewFile" } 
      %>

      <!-- ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰è²¼ã‚Šä»˜ã‘ãƒœã‚¿ãƒ³ -->
      <button id="paste_button" 
              type="button" 
              data-action="click->clipboard#paste"
              class="whitespace-nowrap px-4 py-2 bg-purple-600 text-sm font-medium rounded-full hover:bg-purple-700 transition">
        <div class="text-black">ğŸ“‹ Paste</div>
      </button>
    </div>
    <p id="paste_info" class="text-xs text-gray-500 mt-2">â€»PCå†…ã®ç”»åƒã‚’é¸æŠã™ã‚‹ã‹ã€ç”»åƒã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€ŒPasteã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>
  </div>

  <div class="my-5">
    <%= form.label :title %>
    <%= form.text_field :title, class: "block shadow rounded-md border border-gray-200 outline-none px-3 py-2 mt-2 w-full" %>
  </div>

  <div class="my-5">
    <%= form.label :url %>
    <%= form.text_area :url, rows: 3, class: "block shadow rounded-md border border-gray-200 outline-none px-3 py-2 mt-2 w-full" %>
  </div>

  <!-- åº§æ¨™ã¯ç·¨é›†ç”»é¢ã§ã¯è§¦ã‚‰ãªã„ã®ã§ hidden ã«ã™ã‚‹ -->
  <%= form.hidden_field :x_coordinate %>
  <%= form.hidden_field :y_coordinate %>

  <div class="inline">
    <%= form.submit class: "rounded-lg py-3 px-5 bg-blue-600 text-white inline-block font-medium cursor-pointer" %>
    <%= link_to "Cancel", links_path(board_id: @link.board_id), class: "ml-2 rounded-lg py-3 px-5 bg-gray-100 inline-block font-medium" %>
  </div>
<% end %>