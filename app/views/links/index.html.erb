<div class="flex h-screen w-full bg-gray-50 overflow-hidden">
  
  <!-- ======================== -->
  <!-- 1. Â∑¶„Çµ„Ç§„Éâ„Éê„Éº („Éú„Éº„Éâ‰∏ÄË¶ß) -->
  <!-- ======================== -->
  <div class="w-64 bg-white border-r border-gray-200 flex flex-col flex-shrink-0 z-20">
    <!-- „Ç¢„Éó„É™„É≠„Ç¥„Ç®„É™„Ç¢ -->
    <div class="h-16 flex items-center px-6 border-b border-gray-100">
      <h1 class="font-bold text-xl text-gray-800 tracking-tight">LinkCanvas</h1>
    </div>

    <!-- „Éú„Éº„Éâ„É™„Çπ„Éà („Çπ„ÇØ„É≠„Éº„É´ÂèØ) -->
    <div class="flex-1 overflow-y-auto py-4 px-3 space-y-1">
      <div class="px-3 mb-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">
        Your Boards
      </div>
      
      <% @boards.each do |board| %>
        <% is_active = (@active_board&.id == board.id) %>
        <div class="group flex items-center justify-between px-3 py-2 text-sm font-medium rounded-md transition-colors <%= is_active ? 'bg-blue-50 text-blue-700' : 'text-gray-700 hover:bg-gray-100' %>">
          
          <!-- „É°„Ç§„É≥: „Éú„Éº„ÉâÈÅ∏Êäû„É™„É≥„ÇØ (Â∑¶ÂÅ¥„ÅÆÂ∫É„ÅÑ„Ç®„É™„Ç¢) -->
          <%= link_to links_path(board_id: board.id), 
              data: { turbo_action: "replace" },
              class: "flex-1 flex items-center truncate mr-2" do %>
            <span class="mr-3 text-lg opacity-70">
              <%= is_active ? 'üìÇ' : 'üìÅ' %>
            </span>
            <span class="truncate"><%= board.name %></span>
          <% end %>
          
          <!-- „Çµ„Éñ: Êìç‰Ωú„Éú„Çø„É≥ („Ç¢„ÇØ„ÉÜ„Ç£„ÉñÊôÇ„Åæ„Åü„ÅØ„Éõ„Éê„ÉºÊôÇ„Å´Ë°®Á§∫) -->
          <% if is_active && (board != @boards.first) %>
            <div class="flex items-center gap-1">
              <!-- Á∑®ÈõÜ„Éú„Çø„É≥ -->
              <%= link_to edit_board_path(board), class: "p-1.5 text-gray-400 hover:text-blue-600 hover:bg-white rounded transition", title: "ÂêçÂâçÂ§âÊõ¥" do %>
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg>
              <% end %>
              
              <!-- ÂâäÈô§„Éú„Çø„É≥ -->
              <%= link_to board, 
                  data: { turbo_method: :delete, turbo_confirm: "„Äå#{board.name}„Äç„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü\n‰∏≠„Å´Âê´„Åæ„Çå„Çã„É™„É≥„ÇØ„ÇÇÂÖ®„Å¶ÂâäÈô§„Åï„Çå„Åæ„Åô„ÄÇ" }, 
                  class: "p-1.5 text-gray-400 hover:text-red-500 hover:bg-white rounded transition", 
                  title: "ÂâäÈô§" do %>
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
              <% end %>
            </div>
          <% end %>
        </div>
      <% end %>

      <!-- „Éú„Éº„Éâ‰ΩúÊàê„Éú„Çø„É≥ -->
      <%= link_to new_board_path, class: "flex items-center px-3 py-2 text-sm font-medium text-gray-500 hover:text-blue-600 hover:bg-gray-50 rounded-md transition-colors mt-2" do %>
        <span class="mr-3 text-lg">Ôºã</span>
        <span>Create New Board</span>
      <% end %>
    </div>

    <!-- „Éò„É´„Éó„É¢„Éº„ÉÄ„É´ -->
    <div data-controller="help">
      <!-- „Éò„É´„Éó„Éú„Çø„É≥ (Âè≥‰∏ã„Å´Âõ∫ÂÆö) -->
      <button data-action="click->help#open" 
              class="fixed bottom-6 right-6 w-12 h-12 bg-white text-gray-600 rounded-full shadow-lg border border-gray-200 flex items-center justify-center hover:bg-blue-600 hover:text-white transition-colors z-50"
              title="‰Ωø„ÅÑÊñπ„Ç¨„Ç§„Éâ">
        <span class="text-xl font-bold">?</span>
      </button>

      <!-- „É¢„Éº„ÉÄ„É´Ë™≠„ÅøËæº„Åø -->
      <%= render "help_modal" %>
    </div>

    <!-- ‰∏ãÈÉ®: „É¶„Éº„Ç∂„ÉºÊÉÖÂ†± & Êã°ÂºµÊ©üËÉΩ -->
    <div class="p-4 border-t border-gray-200 bg-gray-50">
      <!-- Êã°ÂºµÊ©üËÉΩ„É™„É≥„ÇØ -->
      <a href="/linkcanvas-extension.zip" download class="flex items-center justify-center w-full px-4 py-2 mb-4 text-xs font-bold text-blue-700 bg-blue-100 rounded hover:bg-blue-200 transition">
        üß© Êã°ÂºµÊ©üËÉΩ„ÇíDL
      </a>

      <!-- „É¶„Éº„Ç∂„ÉºÂêç & „É≠„Ç∞„Ç¢„Ç¶„Éà -->
      <div class="flex items-center justify-between">
        <%= link_to edit_user_registration_path do %>
        <div class="flex items-center min-w-0">
          <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-xs">
            <%= current_user.name.first.upcase %>
          </div>
          <div class="ml-2 truncate">
            <p class="text-sm font-medium text-gray-700 truncate"><%= current_user.name %></p>
          </div>
        </div>
        <% end %>
        <%= button_to destroy_user_session_path, method: :delete, class: "text-gray-400 hover:text-red-500" do %>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" title="Logout"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
        <% end %>
      </div>
      
      <!-- API„Éà„Éº„ÇØ„É≥ („ÇØ„É™„ÉÉ„ÇØ„Åß„Ç≥„Éî„Éº) -->
      <div class="mt-2 text-[10px] text-gray-400 truncate cursor-pointer hover:text-gray-600" title="API Token: Click to copy" onclick="navigator.clipboard.writeText('<%= current_user.authentication_token %>'); alert('Copied Token!');">
        Token: <%= current_user.authentication_token %>
      </div>
    </div>
  </div>

  <!-- ======================== -->
  <!-- 2. „É°„Ç§„É≥„Ç®„É™„Ç¢ („Ç≠„É£„É≥„Éê„Çπ) -->
  <!-- ======================== -->
  <div class="flex-1 flex flex-col h-full relative overflow-hidden">
    
    <% if @active_board %>
      <!-- „Éò„ÉÉ„ÉÄ„Éº -->
      <div class="h-16 bg-white shadow-sm border-b border-gray-200 flex items-center justify-between px-6 z-10 flex-shrink-0">
        <div class="flex items-center gap-4">
          <h2 class="text-xl font-bold text-gray-800"><%= @active_board.name %></h2>
          <span class="bg-gray-100 text-gray-500 text-xs px-2 py-1 rounded-full"><%= @links.count %> cards</span>
        </div>
        
        <div>
          <!-- „É™„É≥„ÇØ‰ΩúÊàê„Éú„Çø„É≥ (ÁèæÂú®„ÅÆ„Éú„Éº„ÉâID„ÇíÊ∏°„Åô) -->
          <%= link_to new_link_path(board_id: @active_board.id), class: "flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium shadow-sm transition" do %>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
            Add Link
          <% end %>
        </div>
      </div>

      <!-- „Ç≠„É£„É≥„Éê„Çπ (ÁÑ°Èôê„Çπ„ÇØ„É≠„Éº„É´È†òÂüü) -->
      <div class="flex-1 bg-gray-50 relative overflow-auto" style="cursor: default;">

        <%= turbo_stream_from @active_board %>

        <!-- Â∫ÉÂ§ß„Å™„Ç®„É™„Ç¢„ÇíÁ¢∫‰øù -->
        <div class="relative" style="width: 3000px; height: 3000px;">
          <div id="links">
            <%= render partial: 'link', collection: @links %>
          </div>
        </div>
      </div>

    <% else %>
      <!-- „Éú„Éº„Éâ„Åå„Å™„ÅÑÂ†¥Âêà„ÅÆË°®Á§∫ -->
      <div class="flex-1 flex flex-col items-center justify-center bg-gray-50">
        <p class="text-gray-500 mb-4">„Éú„Éº„Éâ„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</p>
        <%= link_to "Êñ∞„Åó„ÅÑ„Éú„Éº„Éâ„Çí‰ΩúÊàê", new_board_path, class: "text-blue-600 hover:underline" %>
      </div>
    <% end %>
  </div>
</div>